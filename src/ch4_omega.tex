\section{\texorpdfstring{$\omega$}{omega}-Hausdorff rank}

\begin{lemma}
  Let $\alpha > 0$ be an ordinal.

  Let $M$ be a countable linear order.

  Then $M \in \qqo^{\le \alpha}$ iff $M$ is a finite sum of $\bounded{\qqo^{< \alpha}}$-subintervals.
\end{lemma}

\begin{proof}
  From the previous lemma, it is clear that if $M$ is a finite sum of $\bounded{\qqo^{< \alpha}}$-subintervals,
  then $M \in \qqo^{\le \alpha}$, since the rank bound is preserved under finite sums.

  Conversely, suppose $M \in \qqo^{\le \alpha}$.

  \emph{If} $M = \sum_{i \in I} M_i$ for some $M_i \in \qqo^{< \alpha}$ for $I \in \qqo$,
  take $x, y \in M$. Then let $x \in M_{i_1}$ and $y \in M_{i_2}$.

  Then $[x, y] \subseteq \sum_{i \in [i_1, i_2]} M_i$.

  But the distance between $i_1$ and $i_2$ is at most $1$, so $\sum_{i \in [i_1, i_2]} M_i$ is a finite sum of
  $\bounded{\qqo^{< \alpha}}$-subintervals.

  So we have proven that each interval which is a $\qqo$-sum of linear orders of
  $\omega$-rank $< \alpha$ is in $\bounded{\qqo^{< \alpha}}$.

  But generally, $M$ is a finite sum of such $\oo$-sums, so it is a finite sums
  of $\bounded{\qqo^{< \alpha}}$-subintervals.
\end{proof}

\begin{definitions}
  Let $\alpha > 0$ be an ordinal.

  Let $M$ be a linear order.

  We define:
  \begin{enumerate}
    \item $\mathcal{L}_{\alpha} := \set{M \in \bounded{\qqo^{< \alpha}} : 1 + M \in \bounded{\qqo^{< \alpha}}}$
    \item $\mathcal{R}_{\alpha} := \set{M \in \bounded{\qqo^{< \alpha}} : M + 1 \in \bounded{\qqo^{< \alpha}}}$
  \end{enumerate}

  And then:
  \begin{enumerate}
    \item $\mathcal{S}^{1}_{\alpha} := L_{\alpha} \cap R_{\alpha}$
    \item $\mathcal{S}^{\omega}_{\alpha} := L_{\alpha} \setminus R_{\alpha}$
    \item $\mathcal{S}^{\agemo}_{\alpha} := R_{\alpha} \setminus L_{\alpha}$
    \item $\mathcal{S}^{\oo}_{\alpha} := \bounded{\qqo^{< \alpha}} \setminus (L_{\alpha} \cup R_{\alpha})$
  \end{enumerate}

  In particular, by the definition,
  \[
    \bounded{\qqo^{< \alpha}}
    = \mathcal{S}^{1}_{\alpha}
    \uplus \mathcal{S}^{\omega}_{\alpha}
    \uplus \mathcal{S}^{\agemo}_{\alpha}
    \uplus \mathcal{S}^{\oo}_{\alpha}
  \]

  Let $M \in \bounded{\qqo^{< \alpha}}$.

  We define \emph{the} $\alpha$-shape
  of $M$ to be the $s \in \set{1, \omega, \agemo, \oo}$
  for which $M \in \mathcal{S}^{s}_{\alpha}$.
\end{definitions}

\begin{lemma}\label{b_alpha-structure-lemma-1}
  \[
    \mathcal{S}^{1}_{\alpha} = \qqo^{< \alpha}
  \]
\end{lemma}

\begin{proof}
  ($\supseteq$) Let $M \in \qqo^{< \alpha}$.
  Since $\qqo^{< \alpha}$ is additive, $1 + M$ and $M + 1$ are also in $\qqo^{< \alpha}$.
  Therefore, $M \in \mathcal{L}_{\alpha} \cap \mathcal{R}_{\alpha}
    = \mathcal{S}^{1}_{\alpha}$.

  ($\subseteq$) Let $M \in \mathcal{S}^{1}_{\alpha}$.
  Then $M \in \mathcal{L}_{\alpha}$ and $M \in \mathcal{R}_{\alpha}$,
  so $1 + M, M + 1 \in \bounded{\qqo^{< \alpha}}$.

  By~\cref{star-lemma}, $\bounded{\qqo^{< \alpha}}$ is a star property.
  So $1 + M + 1 \in \bounded{\qqo^{< \alpha}}$. Since it is by itself
  an interval, it is in $\qqo^{< \alpha}$.

  By monotonicity, $M \in \qqo^{< \alpha}$.
\end{proof}

\begin{corollary}
  Let $\alpha > 0$, $\delta \ge 0$ be ordinals.

  Then,
  \[
    \mathcal{S}^{1}_{\alpha + \delta}
    = \sum_{\mathcal{S}^{1}_{1 + \delta}}{\qqo^{< \alpha}}
  \]
\end{corollary}

\begin{proof}
  By~\cref{b_alpha-structure-lemma-1}, we can prove, equivalently,
  that
  \[
    \qqo^{< \alpha + \delta} = \sum_{\qqo^{< 1 + \delta}}{\qqo^{< \alpha}}.
  \]
  We can prove this by induction on $\delta \ge 0$.

  For $\delta = 0$ we need to prove
  \[
    \qqo^{< \alpha} = \sum_{\qqo^{< 1}}{\qqo^{< \alpha}}.
  \]

  Which is true by definition, since $\qqo^{< 1} = \set{1}$. 

  For $\delta = \gamma + 1$, using the induction hypothesis,
  \[
    \begin{aligned}
      \qqo^{< \alpha + \gamma + 1}
       & = \sum_{\qqo}{\qqo^{< \alpha + \gamma}}                    \\
       & = \sum_{\qqo}{\sum_{\qqo^{< 1 + \gamma}}{\qqo^{< \alpha}}} \\
       & = \sum_{\sum_{\qqo}{\qqo^{< 1 + \gamma}}}{\qqo^{< \alpha}} \\
       & = \sum_{\qqo^{< 1 + \gamma + 1}}{\qqo^{< \alpha}}          \\
       & = \sum_{\qqo^{1 + \delta}}{\qqo^{< \alpha}}
    \end{aligned}
  \]

  For $\delta$ a limit ordinal,
  \[
    \begin{aligned}
      \qqo^{< \alpha + \delta}
       & = \bigcup_{\gamma < \delta}{\qqo^{< \alpha + \gamma}} \\
       & = \bigcup_{\gamma < \delta}{\sum_{\qqo^{< 1 + \gamma}}{\qqo^{< \alpha}}} \\
       & = \sum_{\bigcup_{\gamma < \delta}{\qqo^{< 1 + \gamma}}}{\qqo^{< \alpha}} \\
       & = \sum_{\qqo^{< 1 + \delta}}{\qqo^{< \alpha}}
    \end{aligned}
  \]

\end{proof}

\begin{lemma}\label{b_alpha-structure-lemma-2}
  Let $\alpha > 0$ be an ordinal.
  Let $s \in \set{\omega, \agemo, \oo}$.

  Suppose that
  $\alpha = \sup_{i \in s} \ps{\alpha_i + 1}$ for
  ordinals $\alpha_i > 0$ for all $i \in s$.

  Then, we have the following:

  \[
    \mathcal{S}^{s}_{\alpha} = \sum_{i \in s}{\qqo^{< \alpha_i}}
  \]
\end{lemma}

\begin{proof}
\end{proof}

\begin{corollary}
  Let $\alpha > 0$, $\delta \ge 0$ be ordinals.

  Let $s \in \set{\omega, \agemo, \oo}$

  Then,

  \[
    \mathcal{S}^{s}_{\alpha + \delta}
    = \sum_{\mathcal{S}^{s}_{1 + \delta}}{\qqo^{< \alpha}}
  \]
\end{corollary}

\begin{proof}
  Suppose that $\delta = \sup_{i \in s} \ps{\delta_i + 1}$.

  Then $\alpha + \delta = \sup_{i \in s} \ps{\alpha_i + 1 + \delta_i}$.

  \[
    \mathcal{S}^{s}_{\alpha + \delta}
    = \sum_{i \in s}{\mathcal{S}^{s}_{\alpha + \delta_i}}
    = \sum_{i \in s}\sum_{\qqo^{< 1 + \delta_i}}{\qqo^{< \alpha}}
    = \sum_{\sum_{i \in s}{\qqo^{< 1 + \delta_i}}}{\qqo^{< \alpha}}
    = \sum_{\mathcal{S}^{s}_{1 + \delta}}{\qqo^{< \alpha}}
  \]
\end{proof}
